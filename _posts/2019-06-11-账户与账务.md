---
title: 账户与账务
categories:
 - Java
---

## 账户的设计需求
在支付系统中，账户的设置，主要是从如下几个方面来考虑：

* 交易的需求，比如检查账户是否被锁定、余额是否足够、是否有效等。
* 记账的需求，按照公司会计需求记录账户上的所有行为，包括支出、充值、转账等。
* 对账的需求，包括和支付渠道、商户、个人的对账需求，核对交易和账户余额是否正确。
* 风控的需求，如反洗钱、反欺诈等，都需要依赖于账户体系来提供核心数据。
* 信用的需求，对用户、资产、商户等主体进行信用评估时，也需要依赖账户体系来提供的核心数据。

## 交易与账户
存在两种支付模式。
1. 从一个账户直接流向另外一个账户，存在交易主体和交易对手两个对象
2. 资金从交易主体经由支付渠道账户流向交易对手账户，一次交易会涉及到三个账户： 交易主体账户、交易对手账户以及支付渠道账户

## 记账与账户
公司的会计需要对每一笔交易都要做详细的记录，即记账。 
按照公司的规模和业务复杂度，可以有一级，二级，三级或者更多级的结构，这被称之为会计科目。 
记账时，除了交易明细，还需要在每个级别上对交易额进行汇总。 一般来说，一级科目上汇总称为总帐科目，而详细记录称为明细科目。

电商的参与者可以分为商户、买家和渠道，对这三类参与者，都需要分别建立总帐账户和明细账户。

## 内部账户与外部账户
在银行或者第三方支付的系统内的账户成为外部账户，
因我们无法感知用户真正的余额或者在某些业务需要感知用户充值金额比如说零钱玩法，
需要在我们的应用内建立账户，称之为内部账户

## 账户建模
账户建模本身包括三大核心模型：实体模型、账户模型和交易模型。
从交易模型中可以衍生出针对各个角色的账户流水，即明细模型，用于支持对账。

## 实体模型

## 账户模型

## 总结
如果没有需求对接财务系统，那么无需设计会计相关的字段，即使需要，在流水中添加对应的会计分类即可。
在流水中主要的字段分别是科目、金额、币别、交易主体。













