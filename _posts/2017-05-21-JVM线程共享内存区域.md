---
title: JVM线程共享内存区域
categories:
 - Java
tags: JVM
---

#### Java堆
虚拟机中管理内存最大的一块，唯一的功能就是**存放对象实例**。该区域是垃圾收集器管理的主要区域，很多时候被称为**GC堆**.
堆内存垃圾收集器采用的是**分代收集算法**,Java堆中可细分为新生代和老年代，
再细致一点新生代可分为Eden空间，From Survivor空间和To Survivor空间。
可通过-Xmx和-Xms控制堆内存的最大最小内存值,将两个值设为一样可避免自动扩展，
内存变化的会导致JVM消耗额外的资源和性能来缩小或者开辟内存。
可以更细致的去划分堆内存空间，通过-Xmn来设置堆内存内年轻代内存。
因为在jvm中如果老年代将满的时候会发生full gc，会停顿所有用户线程，所以一般情况下分配的新生代和老年代内存
内存比例是1/3到1/4。可以通过**-XX:NewRatio=老年代/新生代** 参数来配置比例。
在新生代中还可以通过-XX:SurvivorRatio来分配Eden区和Survivor区的比例。
这里的Survivor区指的是两块中的任意一块。
比如说新生代内存为10m，-XX:SurvivorRatio=2，那么内存分配就是10/2+1+1的大小去给各个区域分配。
如果堆中没有内存完成实例分配，并且堆也无法再扩展时，将抛出OutOfMemoryError异常。
#### 方法区
别名Non-Heap(非堆)，很多人把方法去称为**永久代**(Permanent Generation)**,用于存放**类信息，常量，静态变量，即时编译器编译后的代码。
常量池是方法去的一部分，用于存放编译期生成的各种字面量和符号引用。
-XX:PermSize设置永久带最小内存，-XX:MaxPermSize设置永久代最大内存。我觉得这块的参数直接交给jvm处理就可以，
它会配置一个合理的大小。
