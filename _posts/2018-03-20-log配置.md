---
title: 项目中日志配置
categories:
 - Java
tags: log
---

这里主要记录两种配置方式，一种Log4j2，还有一个logback。

````
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
        <!-- %m输出的信息,%p日志级别,%t线程名,%d日期,%c类的全名,,,, -->
        <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
                <encoder>
                        <pattern>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n</pattern>
                </encoder>
        </appender>
        <appender name="INFO" class="ch.qos.logback.core.rolling.RollingFileAppender">
                <file>${sys:pafa.log.home}/pafa_info.log</file>
                <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                        <fileNamePattern>${sys:pafa.log.home}/pafa_info.log.%d{yyyy-MM-dd}</fileNamePattern>
                        <maxFileSize>100MB</maxFileSize>
                        <maxHistory>7</maxHistory>
                        <totalSizeCap>10GB</totalSizeCap>
                </rollingPolicy>
                <filter class="ch.qos.logback.classic.filter.LevelFilter">
                        <level>INFO</level>
                        <onMatch>ACCEPT</onMatch>
                        <onMismatch>DENY</onMismatch>
                </filter>
                <encoder>
                        <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
                </encoder>
        </appender>

        <appender name="WARN"
                class="ch.qos.logback.core.rolling.RollingFileAppender">
                <file>${sys:pafa.log.home}/pafa_warn.log</file>
                <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                        <fileNamePattern>${sys:pafa.log.home}/pafa_warn.log.%d{yyyy-MM-dd}</fileNamePattern>
                        <maxFileSize>100MB</maxFileSize>
                        <maxHistory>7</maxHistory>
                        <totalSizeCap>10GB</totalSizeCap>
                </rollingPolicy>
                <filter class="ch.qos.logback.classic.filter.LevelFilter">
                        <level>WARN</level>
                        <onMatch>ACCEPT</onMatch>
                        <onMismatch>DENY</onMismatch>
                </filter>
                <encoder>
                        <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
                </encoder>
        </appender>

        <appender name="ERROR" class="ch.qos.logback.core.rolling.RollingFileAppender">
                <file>${sys:pafa.log.home}/pafa_error.log</file>
                <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                        <fileNamePattern>${sys:pafa.log.home}/pafa_error.log.%d{yyyy-MM-dd}</fileNamePattern>
                        <maxFileSize>100MB</maxFileSize>
                        <maxHistory>7</maxHistory>
                        <totalSizeCap>10GB</totalSizeCap>
                </rollingPolicy>
                <filter class="ch.qos.logback.classic.filter.LevelFilter">
                        <level>ERROR</level>
                        <onMatch>ACCEPT</onMatch>
                        <onMismatch>DENY</onMismatch>
                </filter>
                <encoder>
                        <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
                </encoder>
        </appender>

        <root level="STDOUT">
                <appender-ref ref="STDOUT" />
                <appender-ref ref="INFO" />
                <appender-ref ref="WARN" />
                <appender-ref ref="ERROR" />
        </root>

</configuration>
````

````
<?xml version="1.0" encoding="UTF-8"?>
<configuration status="info">
	<appenders>
		<Console name="Console" target="SYSTEM_OUT">
			<ThresholdFilter level="error" onMatch="ACCEPT" onMismatch="DENY" />
			<PatternLayout pattern="%d{yyyy-MM-dd 'at' HH:mm:ss.SSS} [%-5level] %x %class{36} %M - %msg%xEx%n" />
		</Console>

		<RollingFile name="ERROR" fileName="${sys:pafa.log.home}/${sys:pizza.app.name}/${sys:pizza.app.name}_error.log"
			filePattern="${sys:pafa.log.home}/${sys:pizza.app.name}/${sys:pizza.app.name}_error_%d{yyyy-MM-dd}_%i.log.gz">
			<Filters>
                <ThresholdFilter level="error" />
            </Filters>
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="100 MB" />
            </Policies>
			<PatternLayout pattern="%d{yyyy-MM-dd 'at' HH:mm:ss.SSS} [%-5level] %x %class{36} %M - %msg%xEx%n" />
		</RollingFile>

		<RollingFile name="pafalog" fileName="${sys:pafa.log.home}/${sys:pizza.app.name}/pafa_info.log"
			filePattern="${sys:pafa.log.home}/${sys:pizza.app.name}/pafa_info_%d{yyyy-MM-dd}_%i.log.gz">
			<Filters>
                <ThresholdFilter level="debug" />
                <ThresholdFilter level="WARN" onMatch="ACCEPT" onMismatch="NEUTRAL" />
            </Filters>
            <Policies>
                <TimeBasedTriggeringPolicy modulate="true" interval="1" />
                <SizeBasedTriggeringPolicy size="100 MB" />
            </Policies>
			<PatternLayout pattern="%d{yyyy-MM-dd 'at' HH:mm:ss.SSS} [%-5level] %x %class{36} %M - %msg%xEx%n" />
		</RollingFile>
		
		<RollingFile name="service_log" fileName="${sys:pafa.log.home}/${sys:pizza.app.name}/${sys:pizza.app.name}_info.log"
			filePattern="${sys:pafa.log.home}/${sys:pizza.app.name}/${sys:pizza.app.name}_info.%d{yyyy-MM-dd}-%i.log.gz">
			<Filters>
                <ThresholdFilter level="debug" />
                <ThresholdFilter level="WARN" onMatch="ACCEPT" onMismatch="NEUTRAL" />
            </Filters>
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="100 MB" />
            </Policies>
			<PatternLayout pattern="%d{yyyy-MM-dd 'at' HH:mm:ss.SSS} [%-5level] %x %class{36} %M - %msg%xEx%n" />
		</RollingFile>
	</appenders>

	<loggers>
		<Root level="debug">
            <AppenderRef ref="Console" />
            <AppenderRef ref="ERROR" />
        </Root>
        
	    <Logger name="com.sys.common.dao.mapper" level="debug" additivity="false">
	      	<AppenderRef ref="Console"/>  
	        <AppenderRef ref="service_log" />
	    </Logger>
	    
	    <Logger name="com.sys" level="debug" additivity="false">
	        <AppenderRef ref="service_log" />
	    </Logger>
	</loggers>
	
</configuration>  
````



